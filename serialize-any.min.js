!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).SerAny=e()}}(function(){var define,module,exports;return function(){return function e(r,t,a){function i(o,s){if(!t[o]){if(!r[o]){var y="function"==typeof require&&require;if(!s&&y)return y(o,!0);if(n)return n(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var c=t[o]={exports:{}};r[o][0].call(c.exports,function(e){return i(r[o][1][e]||e)},c,c.exports,e,r,t,a)}return t[o].exports}for(var n="function"==typeof require&&require,o=0;o<a.length;o++)i(a[o]);return i}}()({1:[function(require,module,exports){const deepCopy=require("deep-copy-all"),defaultOptions={maxDepth:20,pretty:!1};function serialize(e,r){void 0===(r=r||defaultOptions).maxDepth&&(r.maxDepth=defaultOptions.maxDepth),void 0===r.pretty&&(r.pretty=defaultOptions.pretty);let t=deepCopy(e);const a={_Serialize_Any_Encoded:!0,_SA_Content:t=function e(r,t,a){a++;if(a>t.maxDepth)throw"Error maximum depth exceeded - possible circular reference";let i="    ";for(let e=0;e<a;e++)i+="  ";const n=objectType(r);const o=objectBehaviors[n];const s=o.serialize;const y=o.iterate;const l=o.setValue;y&&y(r,i=>{const n=i.type,o=objectBehaviors[n],s=o.serialize,y=o.iterate,c=i.value;y?i.value=e(i.value,t,a):s&&(i.value=s(i.value));const u=i.value!==c;u&&l(r,i)});s&&(r=s(r));return r}(t,r,0)};return r.pretty?JSON.stringify(a,null,2):JSON.stringify(a)}function deserialize(e,r){let t=JSON.parse(e);if("Object"!==objectType(t)||!t._Serialize_Any_Encoded)throw"Error: object was not serialized by serialize-any";return function e(r,t,a){a++;let i="    ";for(let e=0;e<a;e++)i+="  ";let n=objectType(r);let o=objectBehaviors[n];const s=o.deserialize;s&&(r=s(r,t),n=objectType(r),o=objectBehaviors[n]);const y=o.iterate;if(y){const i=o.setValue;y(r,n=>{const o=n.type,s=objectBehaviors[o],y=s.deserialize,l=s.iterate;l?n.value=e(n.value,t,a):y&&(n.value=y(n.value,t),i(r,n))})}return r}(t=t._SA_Content,r,0)}const isPrimitive=e=>{let r=typeof e;return"number"===r||"string"===r||"boolean"===r||"symbol"===r||null===e},objectType=e=>{let r=null;const t=e&&e.constructor&&e.constructor.name;return r=isPrimitive(e)||!e instanceof Object?"primitive":void 0===e?"undef":"bigint"==typeof e?"BigInt":e._SAType&&e._SAType.includes("_SACustom")?e._SAType:void 0!==e._SAType?e._SAType+"_Serialized":"string"==typeof t&&t.length&&objectBehaviors[t]?t:e instanceof Array&&"Array"!==t?"CustomArray":e instanceof Object&&"Object"!==t?"CustomObject":e instanceof Array?"CustomObject":"Object"},objectBehaviors={Array:{type:Array,serialize:e=>"Array"!==e.constructor.name?{_SAType:"_SACustomArray",_SAconstructorName:e.constructor.name,_SAvalues:Array.from(e)}:e,iterate:(e,r)=>{const t=e.length;for(let a=0;a<t;a++){const t=e[a];r({key:a,value:t,type:objectType(t)})}},setValue:(e,r)=>{e[r.key]=r.value}},Date:{type:Date,serialize:e=>({_SAType:"Date",_SAtimestamp:e.getTime()})},Date_Serialized:{deserialize:e=>new Date(e._SAtimestamp)},RegExp:{type:RegExp,serialize:e=>({_SAType:"RegExp",_SAsource:e.source,_SAflags:e.flags})},RegExp_Serialized:{deserialize:e=>new RegExp(e._SAsource,e._SAflags||"")},Function:{type:Function,serialize:e=>({_SAType:"Function",_SAfunction:e.toString()})},Function_Serialized:{deserialize:e=>new Function("return "+e._SAfunction)()},undef:{serialize:e=>({_SAType:"undef"})},undef_Serialized:{deserialize:e=>{}}};"undefined"!=typeof BigInt&&Object.assign(objectBehaviors,{BigInt:{type:BigInt,serialize:e=>({_SAType:"BigInt",_SAnum:e.toString()})},BigInt_Serialized:{deserialize:e=>BigInt(e._SAnum)}}),"undefined"!=typeof Int8Array&&Object.assign(objectBehaviors,{Int8Array:{type:Int8Array,serialize:e=>({_SAType:"Int8Array",_SAvalues:Array.from(e)})},Int8Array_Serialized:{deserialize:e=>Int8Array.from(e._SAvalues)}}),"undefined"!=typeof Uint8Array&&Object.assign(objectBehaviors,{Uint8Array:{type:Uint8Array,serialize:e=>({_SAType:"Uint8Array",_SAvalues:Array.from(e)})},Uint8Array_Serialized:{deserialize:e=>Uint8Array.from(e._SAvalues)}}),"undefined"!=typeof Uint8ClampedArray&&Object.assign(objectBehaviors,{Uint8ClampedArray:{type:Uint8ClampedArray,serialize:e=>({_SAType:"Uint8ClampedArray",_SAvalues:Array.from(e)})},Uint8ClampedArray_Serialized:{deserialize:e=>Uint8ClampedArray.from(e._SAvalues)}}),"undefined"!=typeof Int16Array&&Object.assign(objectBehaviors,{Int16Array:{type:Int16Array,serialize:e=>({_SAType:"Int16Array",_SAvalues:Array.from(e)})},Int16Array_Serialized:{deserialize:e=>Int16Array.from(e._SAvalues)}}),"undefined"!=typeof Uint16Array&&Object.assign(objectBehaviors,{Uint16Array:{type:Uint16Array,serialize:e=>({_SAType:"Uint16Array",_SAvalues:Array.from(e)})},Uint16Array_Serialized:{deserialize:e=>Uint16Array.from(e._SAvalues)}}),"undefined"!=typeof Int32Array&&Object.assign(objectBehaviors,{Int32Array:{type:Int32Array,serialize:e=>({_SAType:"Int32Array",_SAvalues:Array.from(e)})},Int32Array_Serialized:{deserialize:e=>Int32Array.from(e._SAvalues)}}),"undefined"!=typeof Uint32Array&&Object.assign(objectBehaviors,{Uint32Array:{type:Uint32Array,serialize:e=>({_SAType:"Uint32Array",_SAvalues:Array.from(e)})},Uint32Array_Serialized:{deserialize:e=>Uint32Array.from(e._SAvalues)}}),"undefined"!=typeof Float32Array&&Object.assign(objectBehaviors,{Float32Array:{type:Float32Array,serialize:e=>({_SAType:"Float32Array",_SAvalues:Array.from(e)})},Float32Array_Serialized:{deserialize:e=>Float32Array.from(e._SAvalues)}}),"undefined"!=typeof Float64Array&&Object.assign(objectBehaviors,{Float64Array:{type:Float64Array,serialize:e=>{let r=[];return e.forEach(e=>r.push(e.toString())),{_SAType:"Float64Array",_SAvalues:r}}},Float64Array_Serialized:{deserialize:e=>Float64Array.from(e._SAvalues)}}),"undefined"!=typeof BigInt64Array&&Object.assign(objectBehaviors,{BigInt64Array:{type:BigInt64Array,serialize:e=>{let r=[];return e.forEach(e=>r.push(e.toString())),{_SAType:"BigInt64Array",_SAvalues:r}}},BigInt64Array_Serialized:{deserialize:e=>BigInt64Array.from(e._SAvalues)}}),"undefined"!=typeof BigUint64Array&&Object.assign(objectBehaviors,{BigUint64Array:{type:BigUint64Array,serialize:e=>{let r=[];return e.forEach(e=>r.push(e.toString())),{_SAType:"BigUint64Array",_SAvalues:r}}},BigUint64Array_Serialized:{deserialize:e=>BigUint64Array.from(e._SAvalues)}}),"undefined"!=typeof ArrayBuffer&&Object.assign(objectBehaviors,{ArrayBuffer:{type:ArrayBuffer,serialize:e=>{const r=new Uint8Array(e);let t=[];return r.forEach(e=>{t.push(e)}),{_SAType:"ArrayBuffer",_SAvalues:t}}},ArrayBuffer_Serialized:{deserialize:e=>{const r=e._SAvalues,t=new ArrayBuffer(r.length);return new Uint8Array(t).set(r),t}}}),"undefined"!=typeof Map&&Object.assign(objectBehaviors,{Map:{type:Map,serialize:e=>{let r=[];return e.forEach((e,t)=>{r.push([t,e])}),{_SAType:"Map",_SAkvPairs:r}},iterate:(e,r)=>{e.forEach((e,t)=>{const a={key:t,value:e,type:objectType(e)};r(a)})},setValue:(e,r)=>{e.set(r.key,r.value)}},Map_Serialized:{deserialize:e=>{const r=e._SAkvPairs,t=new Map;return r.forEach(([e,r])=>{t.set(e,r)}),t}}}),"undefined"!=typeof Set&&Object.assign(objectBehaviors,{Set:{type:Set,serialize:e=>{let r=[];return e.forEach(e=>r.push(e)),{_SAType:"Set",_SAvalues:r}},iterate:(e,r)=>{e.forEach(e=>{const t={key:null,value:e,originalValue:e,type:objectType(e)};r(t)})},setValue:(e,r)=>{e.delete(r.originalValue),e.add(r.value),r.originalValue=r.value}},Set_Serialized:{deserialize:e=>new Set(e._SAvalues)}}),"undefined"!=typeof WeakSet&&Object.assign(objectBehaviors,{WeakSet:{type:WeakSet,serialize:()=>{throw"Error: serialize WeakSet not supported"}}}),"undefined"!=typeof WeakMap&&Object.assign(objectBehaviors,{WeakMap:{type:WeakMap,serialize:()=>{throw"Error: serialize WeakMap not supported"}}}),"undefined"!=typeof Buffer&&Object.assign(objectBehaviors,{Buffer:{type:Buffer,serialize:e=>({_SAType:"Buffer",_SAutf8String:e.toString()})},Buffer_Serialized:{deserialize:e=>Buffer.from(e._SAutf8String)}}),"undefined"!=typeof Error&&Object.assign(objectBehaviors,{Error:{type:Error,serialize:e=>({_SAType:"Error",_SAmessage:e.message,_SAstack:e.stack})},Error_Serialized:{deserialize:e=>{const r=Error(e._SAmessage);return r.stack=e._SAstack,r}}}),Object.assign(objectBehaviors,{CustomArray:{serialize:e=>({_SAType:"_SACustomArray",_SAconstructorName:e.constructor.name,_SAvalues:Array.from(e)}),iterate:(e,r)=>{const t=e.length;for(let a=0;a<t;a++){const t=e[a];r({key:a,value:t,type:objectType(t)})}},setValue:(e,r)=>{e[r.key]=r.value}},CustomObject:{serialize:e=>({_SAType:"_SACustomObject",_SAconstructorName:e.constructor.name,_SAobject:Object.assign({},e)}),iterate:(e,r)=>{const t=Object.keys(e),a=t.length;for(let i=0;i<a;i++){const a=t[i],n=e[a];r({key:a,value:n,type:objectType(n)})}},setValue:(e,r)=>{e[r.key]=r.value}},Object:{type:Object,iterate:(e,r)=>{const t=Object.keys(e),a=t.length;for(let i=0;i<a;i++){const a=t[i],n=e[a];r({key:a,value:n,type:objectType(n)})}},setValue:(e,r)=>{e[r.key]=r.value}},_SACustomObject:{deserialize:(srcSer,getCustomObject)=>{const cName=srcSer._SAconstructorName,cNameDefined=eval("typeof "+cName+' !== "undefined"'),srcObj=srcSer._SAobject;let cObj;if(cNameDefined)cObj=new eval(cName)();else{if(!getCustomObject)throw"Error: deserialize _SACustomObject - getCustomObject missing";cObj=getCustomObject(cName)}if(!cObj)throw'Error: unable to deserialize - "'+cName+'" undefined';return Object.assign(cObj,srcObj),cObj}},_SACustomArray:{deserialize:(srcSer,getCustomObject)=>{const cName=srcSer._SAconstructorName,cNameDefined=eval("typeof "+cName+' !== "undefined"');let values=srcSer._SAvalues,array;if(cNameDefined)array=new eval(cName)();else{if(!getCustomObject)throw"Error: deserialize _SACustomArray - getCustomObject missing";array=getCustomObject(cName)}if(!array)throw'Error: deserialize _SACustomArray - "'+cName+'" undefined';return array=array.concat(array,values),array}},unknown:{},primitive:{}}),module.exports={serialize:serialize,deserialize:deserialize}},{"deep-copy-all":2}],2:[function(e,r,t){"use strict";const[a,i,n]=e("./object-library.js"),o={goDeep:!0,includeNonEnumerable:!1,maxDepth:20};r.exports=function(e,r){if(void 0===(r=r||o).goDeep&&(r.goDeep=o.goDeep),void 0===r.includeNonEnumerable&&(r.includeNonEnumerable=o.includeNonEnumerable),void 0===r.maxDepth&&(r.maxDepth=o.maxDepth),!r.goDeep)return n[i(e)].makeShallow(e);if(!e||a(e))return e;const t=i(e);if(!n[t].mayDeepCopy)return n[t].makeShallow(e);let y=n[t].makeEmpty(e);return s(e,y,t,0,r),y};const s=(e,r,t,a,i)=>{if(++a>=i.maxDepth)return void console.log("copyObject too deep, depth:",a,",obj:",e);const o=n[t];if(!o.mayDeepCopy)return;const y=o.addElement;(0,o.iterate)(e,i.includeNonEnumerable,e=>{const t=e.value,o=e.type;let l,c=n[o].mayDeepCopy;l=c?n[o].makeEmpty(t):n[o].makeShallow(t),y(r,e.key,l,e.descriptor),c&&s(t,l,o,a,i)})}},{"./object-library.js":3}],3:[function(e,r,t){const a=e=>{let r=typeof e;return"number"===r||"string"===r||"boolean"===r||"undefined"===r||"bigint"===r||"symbol"===r||null===e},i=e=>{if(a(e)||!e instanceof Object)return"primitive";const r=e.constructor&&e.constructor.name&&e.constructor.name.toLowerCase();if("string"==typeof r&&r.length&&n[r])return r;let t;for(const r in n)if(!(t=n[r].type)||e instanceof t)return r;return"unknown"},n={array:{type:Array,mayDeepCopy:!0,addElement:(e,r,t)=>Array.prototype.push.call(e,t),makeEmpty:e=>{const r=[];return Object.setPrototypeOf(r,Object.getPrototypeOf(e)),r},makeShallow:e=>{const r=[...e];return Object.setPrototypeOf(r,Object.getPrototypeOf(e)),r},iterate:(e,r,t)=>{const a=e.length;for(let r=0;r<a;r++){const a=e[r];t({key:r,value:a,type:i(a)})}}},date:{type:Date,makeShallow:e=>new Date(e.getTime())},regexp:{type:RegExp,makeShallow:e=>new RegExp(e)},function:{type:Function,makeShallow:e=>e},error:{type:Error,makeShallow:e=>{const r=new Error(e.message);return r.stack=e.stack,r}}};"undefined"!=typeof Int8Array&&Object.assign(n,{int8array:{type:Int8Array,makeShallow:e=>Int8Array.from(e)}}),"undefined"!=typeof Uint8Array&&Object.assign(n,{uint8array:{type:Uint8Array,makeShallow:e=>Uint8Array.from(e)}}),"undefined"!=typeof Uint8ClampedArray&&Object.assign(n,{uint8clampedarray:{type:Uint8ClampedArray,makeShallow:e=>Uint8ClampedArray.from(e)}}),"undefined"!=typeof Int16Array&&Object.assign(n,{int16array:{type:Int16Array,makeShallow:e=>Int16Array.from(e)}}),"undefined"!=typeof Uint16Array&&Object.assign(n,{uint16array:{type:Uint16Array,makeShallow:e=>Uint16Array.from(e)}}),"undefined"!=typeof Int32Array&&Object.assign(n,{int32array:{type:Int32Array,makeShallow:e=>Int32Array.from(e)}}),"undefined"!=typeof Uint32Array&&Object.assign(n,{uint32array:{type:Uint32Array,makeShallow:e=>Uint32Array.from(e)}}),"undefined"!=typeof Float32Array&&Object.assign(n,{float32array:{type:Float32Array,makeShallow:e=>Float32Array.from(e)}}),"undefined"!=typeof Float64Array&&Object.assign(n,{float64array:{type:Float64Array,makeShallow:e=>Float64Array.from(e)}}),"undefined"!=typeof BigInt64Array&&Object.assign(n,{bigint64array:{type:BigInt64Array,makeShallow:e=>BigInt64Array.from(e)}}),"undefined"!=typeof BigUint64Array&&Object.assign(n,{biguint64array:{type:BigUint64Array,makeShallow:e=>BigUint64Array.from(e)}}),"undefined"!=typeof ArrayBuffer&&Object.assign(n,{arraybuffer:{type:ArrayBuffer,makeShallow:e=>e.slice(0)}}),"undefined"!=typeof Map&&Object.assign(n,{map:{type:Map,mayDeepCopy:!0,addElement:(e,r,t)=>e.set(r,t),makeEmpty:()=>new Map,makeShallow:e=>new Map(e),iterate:(e,r,t)=>{e.forEach((e,r)=>{const a={key:r,value:e,type:i(e)};t(a)})}}}),"undefined"!=typeof Set&&Object.assign(n,{set:{type:Set,mayDeepCopy:!0,addElement:(e,r,t)=>e.add(t),makeEmpty:()=>new Set,makeShallow:e=>new Set(e),iterate:(e,r,t)=>{e.forEach(e=>{const r={key:null,value:e,type:i(e)};t(r)})}}}),"undefined"!=typeof WeakSet&&Object.assign(n,{weakset:{type:WeakSet,makeShallow:e=>e}}),"undefined"!=typeof WeakMap&&Object.assign(n,{weakmap:{type:WeakMap,makeShallow:e=>e}}),"undefined"!=typeof Buffer&&Object.assign(n,{buffer:{type:Buffer,makeShallow:e=>Buffer.from(e)}}),Object.assign(n,{object:{type:Object,mayDeepCopy:!0,addElement:(e,r,t,a)=>{a?Object.defineProperty(e,r,a):e[r]=t},makeEmpty:e=>{const r={};return Object.setPrototypeOf(r,Object.getPrototypeOf(e)),r},makeShallow:e=>{const r=Object.assign({},e);return Object.setPrototypeOf(r,Object.getPrototypeOf(e)),r},iterate:(e,r,t)=>{const a=r?Object.getOwnPropertyNames(e):Object.keys(e),n=a.length;for(let o=0;o<n;o++){const n=a[o],s=e[n],y={key:n,value:s,type:i(s)};r&&!e.propertyIsEnumerable(n)&&(y.descriptor=Object.getOwnPropertyDescriptor(e,n)),t(y)}}},unknown:{makeShallow:e=>e},primitive:{makeShallow:e=>e}}),r.exports=[a,i,n]},{}]},{},[1])(1)});